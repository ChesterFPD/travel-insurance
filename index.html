<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Travel Insurance Comparison ‚Äì Prototype</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --cta: #005b73;
      --cta-hover: #00485a;
      --brand-orange: #f97316;
      --pill-blue: #a7f3f0;
      --pill-blue-text: #0f766e;
      --promo-green: #e7f6e9;
      --muted: #6b7280;
      --card-border: #e5e7eb;
    }

    .cta { background-color: var(--cta); color: #fff; font-weight: 600; font-size: 16px; line-height: 24px; border-radius: 0.5rem; padding: 0.6rem 1.25rem; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; transition: background-color 0.2s ease; white-space: nowrap; }
    .cta:hover { background-color: var(--cta-hover); }
    .cta::after { content: "‚Üí"; font-weight: 700; }

    .more-info { color: var(--brand-orange); text-decoration: underline; font-size: 14px; font-weight: 500; }
    table, th, td { font-size: 16px; line-height: 24px; border-collapse: collapse; }
    th, td { padding: 0.75rem; }

    #compare-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #fff; border-top: 1px solid var(--card-border); box-shadow: 0 -2px 5px rgba(0,0,0,0.05); padding: 0.75rem 1rem; display: none; justify-content: space-between; align-items: center; z-index: 50; }
    .chip { background:#eef2ff; color:#3730a3; font-weight:600; font-size:12px; padding:.25rem .5rem; border-radius:999px; }

    /* Popup modal */
    #cmp-overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:100; }
    #cmp-modal { display:none; position:fixed; inset:0; z-index:110; align-items:center; justify-content:center; }
    #cmp-modal .modal-card { background:#fff; border-radius:0.75rem; width:min(900px,90vw); max-width:90vw; height:min(85vh,760px); max-height:85vh; overflow:hidden; padding:1rem; margin:0 auto; display:flex; flex-direction:column; }

    #cmp-body { overflow:auto; }
    table { width:100%; table-layout:auto; }
    th.sticky-col, td.sticky-col { position:sticky; left:0; background:#f9fafb; z-index:2; }
    th.sticky-col { top:0; z-index:3; background:#f3f4f6; }
    .cmp-col { min-width:160px; max-width:180px; }

    /* Mobile optimizations */
    @media (max-width:640px){
      #compare-bar{flex-direction:column;align-items:stretch;gap:.5rem;padding-bottom:calc(0.75rem + env(safe-area-inset-bottom))}
      #compare-btn{width:100%}
      #selected-products{line-height:1.3}
      #cmp-modal{align-items:flex-end}
      #cmp-modal .modal-card{width:min(480px,92vw);max-width:92vw;height:min(80vh,660px);max-height:80vh;border-radius:.75rem .75rem 0 0;padding:.75rem}
      #cmp-modal h2{font-size:1.125rem}
      #cmp-modal table{table-layout:auto;min-width:360px}
      #cmp-modal th:first-child,#cmp-modal td:first-child{min-width:140px;max-width:160px;background:#f9fafb;position:sticky;left:0;z-index:3}
      #cmp-modal .cmp-col{min-width:140px;max-width:160px}
      #cmp-modal th,#cmp-modal td{font-size:14px;line-height:20px;padding:.75rem;}
      #cmp-modal tfoot td{padding-top:1rem;}
      #cmp-modal tfoot td a.cta{display:block;width:100%;margin:0 auto;margin-bottom:.5rem}
      .product-card{padding:1rem;display:flex;flex-direction:column;gap:.75rem}
      .product-card h2{font-size:1rem;line-height:1.4}
      .product-card .text-2xl{font-size:1.25rem}
      .product-card .cta{width:100%;margin-top:.5rem}
      .product-card .flex.items-center.justify-between{flex-direction:column;align-items:flex-start;gap:.5rem}
      .product-card .promo-banner{display:flex;align-items:center;justify-content:space-between;gap:.25rem;position:relative;padding-right:3rem;}
      .product-card .compare-box{position:absolute;top:.5rem;right:.75rem;margin-top:0}
    }

    /* Desktop refinements */
    @media (min-width:641px){
      .promo-banner{display:flex;align-items:center;justify-content:space-between;position:relative;padding-right:3rem}
      .compare-box{position:absolute;top:.5rem;right:.75rem;margin-top:0}
      #cmp-modal table{table-layout:auto;min-width:540px}
      #cmp-modal thead th{position:sticky;top:0;background:#f3f4f6;z-index:4}
      #cmp-modal th:first-child,#cmp-modal td:first-child{min-width:160px;max-width:180px;background:#f9fafb;position:sticky;left:0;z-index:3}
      #cmp-modal .cmp-col{min-width:160px;max-width:180px}
    }
  /* --- Fix: product headers overlapping the "List of Attributes" cell --- */
#cmp-modal table{ border-collapse: separate; border-spacing: 0; }
/* Make header row sticky and give it a base layer */
#cmp-modal thead th{ position: sticky; top: 0; background: #f3f4f6; z-index: 10; box-shadow: inset 0 -1px 0 #e5e7eb; }
/* First-column HEADER (List of Attributes) ‚Äî on top of everything in header */
#cmp-modal thead th.sticky-col{ left: 0; z-index: 15; box-shadow: 2px 0 0 #e5e7eb, inset 0 -1px 0 #e5e7eb; }
/* First-column BODY/FOOTER cells ‚Äî above body cells */
#cmp-modal tbody td.sticky-col,
#cmp-modal tfoot td.sticky-col{ position: sticky; left: 0; background: #f9fafb; z-index: 12; box-shadow: 2px 0 0 #e5e7eb; }
</style>
</head>
<body class="bg-gray-50 text-gray-900 leading-relaxed">
  <main class="max-w-4xl mx-auto p-4 md:p-6">
    <header class="mb-6">
      <h1 class="text-3xl font-extrabold mb-1">Travel Insurance Comparison</h1>
      <p class="text-gray-600">Compare coverage details across Starr, HL Assurance and MSIG travel insurance plans.</p>
    </header>

    <section class="space-y-6">
      <!-- Starr -->
      <article class="product-card relative border border-gray-200 rounded-xl bg-white shadow-sm p-4">
        <div class="promo-banner bg-green-100 rounded-lg px-3 py-2 text-sm font-semibold">
          üî• Get JISULIFE Fan + up to $70 vouchers upon checkout
          <span class="compare-box inline-flex items-center gap-1">
            <input type="checkbox" class="compare-check w-4 h-4" data-col="1" data-name="Starr TraveLead Bronze"/>
            <span class="text-sm">Compare</span>
          </span>
        </div>
        <div class="mt-3 flex items-center gap-3">
          <img class="h-6" src="https://www.starrcompanies.com/Sitefinity/WebsiteTemplates/StarrCompanies/App_Themes/StarrCompanies/Images/logo.png" alt="Starr"/>
          <h2 class="text-xl font-bold">Starr TraveLead Comprehensive with COVID-19 Coverage (Bronze Plan)</h2>
        </div>
        <div class="mt-3 flex items-center justify-between">
          <div class="text-2xl font-bold">S$ 18.53</div>
          <a href="#" class="cta">Express Checkout</a>
        </div>
        <div class="mt-2 text-sm text-gray-500">
          <span class="line-through">S$ 46.33</span>
          <span class="ml-2 inline-block px-2 py-0.5 rounded-full bg-teal-100 text-teal-700 font-semibold text-xs">60% off</span>
        </div>
      </article>

      <!-- HLAS -->
      <article class="product-card relative border border-gray-200 rounded-xl bg-white shadow-sm p-4">
        <div class="promo-banner bg-green-100 rounded-lg px-3 py-2 text-sm font-semibold">
          üéÅ Get JISULIFE Fan + up to $50 vouchers upon checkout
          <span class="compare-box inline-flex items-center gap-1">
            <input type="checkbox" class="compare-check w-4 h-4" data-col="2" data-name="HLAS Protect360 Basic"/>
            <span class="text-sm">Compare</span>
          </span>
        </div>
        <div class="mt-3 flex items-center gap-3">
          <img class="h-6" src="https://www.hlas.com.sg/themes/custom/hlassurance/logo.png" alt="HL Assurance"/>
          <h2 class="text-xl font-bold">HLAS Travel Protect360 Basic</h2>
        </div>
        <div class="mt-3 flex items-center justify-between">
          <div class="text-2xl font-bold">S$ 20.00</div>
          <a href="#" class="cta">Express Checkout</a>
        </div>
        <div class="mt-2 text-sm text-gray-500">
          <span class="line-through">S$ 50.00</span>
          <span class="ml-2 inline-block px-2 py-0.5 rounded-full bg-teal-100 text-teal-700 font-semibold text-xs">60% off</span>
        </div>
      </article>

      <!-- MSIG -->
      <article class="product-card relative border border-gray-200 rounded-xl bg-white shadow-sm p-4">
        <div class="promo-banner bg-green-100 rounded-lg px-3 py-2 text-sm font-semibold">
          ‚úÖ Get JISULIFE Fan + up to $50 vouchers upon checkout
          <span class="compare-box inline-flex items-center gap-1">
            <input type="checkbox" class="compare-check w-4 h-4" data-col="3" data-name="MSIG Standard Plan"/>
            <span class="text-sm">Compare</span>
          </span>
        </div>
        <div class="mt-3 flex items-center gap-3">
          <img class="h-6" src="https://www.msig.com.sg/themes/custom/msig/logo.png" alt="MSIG"/>
          <h2 class="text-xl font-bold">MSIG Standard Plan</h2>
        </div>
        <div class="mt-3 flex items-center justify-between">
          <div class="text-2xl font-bold">S$ 19.40</div>
          <a href="#" class="cta">Express Checkout</a>
        </div>
        <div class="mt-2 text-sm text-gray-500">
          <span class="line-through">S$ 48.50</span>
          <span class="ml-2 inline-block px-2 py-0.5 rounded-full bg-teal-100 text-teal-700 font-semibold text-xs">60% off</span>
        </div>
      </article>
    </section>
  </main>

  <!-- Compare bar -->
  <div id="compare-bar" class="backdrop-blur">
    <div id="selected-products" class="flex flex-wrap gap-2"></div>
    <button id="compare-btn" class="cta">Compare Now</button>
  </div>

  <!-- Hidden source table for modal cloning -->
  <table id="source-compare" class="hidden">
    <thead>
      <tr>
        <th class="sticky-col">List of Attributes</th>
        <th class="cmp-col">Starr TraveLead Comprehensive (Bronze Plan)</th>
        <th class="cmp-col">HLAS Travel Protect360 Basic</th>
        <th class="cmp-col">MSIG Standard Plan</th>
      </tr>
    </thead>
    <tbody>
      <tr><td class="sticky-col">Price</td><td class="cmp-col">$50</td><td class="cmp-col">$70</td><td class="cmp-col">$90</td></tr>
      <tr><td class="sticky-col">Rewards</td><td class="cmp-col">5% cashback</td><td class="cmp-col">Air miles</td><td class="cmp-col">Hotel vouchers</td></tr>
      <tr><td class="sticky-col">Trip cancellation</td><td class="cmp-col">$2,000</td><td class="cmp-col">$5,000</td><td class="cmp-col">$10,000</td></tr>
      <tr><td class="sticky-col">Loss of baggage</td><td class="cmp-col">$1,000</td><td class="cmp-col">$2,000</td><td class="cmp-col">$3,000</td></tr>
      <tr><td class="sticky-col">Overseas medical expenses</td><td class="cmp-col">$100,000</td><td class="cmp-col">$200,000</td><td class="cmp-col">$300,000</td></tr>
      <tr><td class="sticky-col">Medical expenses in Singapore</td><td class="cmp-col">$10,000</td><td class="cmp-col">$15,000</td><td class="cmp-col">$20,000</td></tr>
    </tbody>
    <tfoot>
      <tr>
        <td class="sticky-col"></td>
        <td class="cmp-col"><a href="#" class="cta">Buy Now</a></td>
        <td class="cmp-col"><a href="#" class="cta">Buy Now</a></td>
        <td class="cmp-col"><a href="#" class="cta">Buy Now</a></td>
      </tr>
    </tfoot>
  </table>

  <!-- Modal -->
  <div id="cmp-overlay"></div>
  <div id="cmp-modal" role="dialog" aria-modal="true" aria-labelledby="cmp-title">
    <div class="modal-card">
      <div class="flex items-center justify-between border-b border-gray-200 pb-2 sticky top-0 bg-white z-10">
        <h2 id="cmp-title" class="text-xl font-bold">Compare Plans</h2>
        <button id="cmp-close" aria-label="Close" class="text-2xl leading-none">‚úï</button>
      </div>
      <div id="cmp-body" class="mt-3"></div>
    </div>
  </div>

  <script>
    // Elements
    const bar = document.getElementById('compare-bar');
    const selectedProducts = document.getElementById('selected-products');
    const compareBtn = document.getElementById('compare-btn');

    // Delegate change: sync duplicates (same data-col) and update bar
    document.addEventListener('change', (e)=>{
      if(!e.target.classList || !e.target.classList.contains('compare-check')) return;
      const col = e.target.dataset.col;
      const checked = e.target.checked;
      document.querySelectorAll('.compare-check[data-col="'+col+'"]').forEach(cb=> cb.checked = checked);
      updateCompareBar();
    });

    function updateCompareBar(){
      const cols = Array.from(new Set(Array.from(document.querySelectorAll('.compare-check:checked')).map(cb => cb.dataset.col)));
      if(cols.length >= 2){
        bar.style.display = 'flex';
        selectedProducts.innerHTML = '';
        cols.forEach(col=>{
          const any = document.querySelector('.compare-check[data-col="'+col+'"]');
          const chip = document.createElement('span');
          chip.className = 'chip';
          chip.textContent = any ? any.dataset.name : ('Plan '+col);
          selectedProducts.appendChild(chip);
        });
      }else{
        bar.style.display = 'none';
      }
    }

    // Modal helpers
    const overlay = document.getElementById('cmp-overlay');
    const modal = document.getElementById('cmp-modal');
    const modalBody = document.getElementById('cmp-body');
    const closeBtn = document.getElementById('cmp-close');

    function openModal(){ overlay.style.display='block'; modal.style.display='flex'; document.body.style.overflow='hidden'; }
    function closeModal(){ overlay.style.display='none'; modal.style.display='none'; document.body.style.overflow=''; modalBody.innerHTML=''; }

    overlay.addEventListener('click', closeModal);
    closeBtn.addEventListener('click', closeModal);
    document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeModal(); });

    function buildCompareTable(colIdx){
      const src = document.getElementById('source-compare');
      const tbl = document.createElement('table');

      // Thead
      const thead = document.createElement('thead');
      const trh = document.createElement('tr');
      const h0 = src.tHead.rows[0].cells[0].cloneNode(true);
      h0.classList.add('sticky-col');
      trh.appendChild(h0);
      colIdx.forEach(i=>{
        const h = src.tHead.rows[0].cells[i].cloneNode(true);
        h.classList.add('cmp-col');
        trh.appendChild(h);
      });
      thead.appendChild(trh);
      tbl.appendChild(thead);

      // Tbody
      const tbody = document.createElement('tbody');
      Array.from(src.tBodies[0].rows).forEach(r=>{
        const tr = document.createElement('tr');
        const c0 = r.cells[0].cloneNode(true); c0.classList.add('sticky-col'); tr.appendChild(c0);
        colIdx.forEach(i=>{
          const c = r.cells[i].cloneNode(true); c.classList.add('cmp-col'); tr.appendChild(c);
        });
        tbody.appendChild(tr);
      });
      tbl.appendChild(tbody);

      // Tfoot
      if(src.tFoot){
        const tf = document.createElement('tfoot');
        Array.from(src.tFoot.rows).forEach(r=>{
          const tr = document.createElement('tr');
          const c0 = r.cells[0].cloneNode(true); c0.classList.add('sticky-col'); tr.appendChild(c0);
          colIdx.forEach(i=>{
            const c = r.cells[i].cloneNode(true); c.classList.add('cmp-col'); tr.appendChild(c);
          });
          tf.appendChild(tr);
        });
        tbl.appendChild(tf);
      }
      return tbl;
    }

    compareBtn.addEventListener('click', ()=>{
      const cols = Array.from(new Set(Array.from(document.querySelectorAll('.compare-check:checked')).map(cb => parseInt(cb.dataset.col,10))));
      if(cols.length < 2) return;
      modalBody.textContent = '';
      modalBody.appendChild(buildCompareTable(cols));
      openModal();
    });
  </script>
</body>
</html>
